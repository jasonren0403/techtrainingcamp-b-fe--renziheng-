# techtrainingcamp-proj-2020
本作品为“玩转前端——北邮”的大作业项目，其在线演示地址为 http://demo.fantasyroom.cn  
* 本项目的代码由作者[@Jason_Ren](https://github.com/jasonren0403) 全部自行编写，此仓库为项目代码库

## 作品需求
* 实现一个搜索应用
    - 支持用户手动输入词，并基于接口调用实现推荐词功能
    - 利用搜索接口返回的结果数据渲染结果页面
    
## 实现思路
* 整体采用[Vue](https://vuejs.org/) 框架制作，由于内容及所涉及到的页面不多，故做成单页应用很有吸引力
    - 本项目采用Vue框架的版本为2.9.6
* 根据需求，总共只需要两种页面的制作
    - 搜索应用主页
    - 搜索结果页
    
### 页面组件设计
* 公用组件
    - `pageFooter.vue`：页脚，放置版权信息和联系方式
    - `fallbackPage.vue`：404页面
* 搜索页组件
    - `searchForm.vue`：搜索框，其中包含用户的输入框和搜索按钮
* 结果页组件
    - `searchResult.vue`：搜索结果，包含有多个`searchResultItem`和一个页面控制组件`pageControl`
    - `searchResultItem.vue`：封装某一搜索结果的显示信息
    - `pageControl.vue`：控制搜索页面的分页，基于`<router-link>`支持第一页、向前一页、向后一页、最后一页四种操作
    
### 路由设计
* 整体项目使用`hash`路由模式，定义有三种路由
    - `home`，即默认路由`/`，对应了搜索应用的主页
    - `search_result`，对应路径`/searchResult/:kw/:page?`，是搜索结果页面
        * 动态参数`kw`的含义为关键词（用户在搜索框中输入的词语），`page`的含义是搜索结果的分页数
            - `offset = (page - 1) * 10`
    - `fallback`，不满足以上条件时进入404页面
    
### 交互设计
* 搜索框
    - 使用动态绑定的`placeholder`变量设置`input`的内容占位符，这样可以根据不同的上下文给出不同的提示，同时，搜索框的外观也有相应变化
    - 推荐词框可以使用键盘上下键切换当前所选
    - 键盘回车键可以提交当前用户输入的关键词
* 搜索结果页
    - 每一个搜索结果使用`vue2-animate`和自带的`<transition>`组件效果做渐入，这样可以让用户更舒服
    - 切换分页时，页面有向上滚动的效果，主要使用`window.scrollTo`中的对象参数`behavior:smooth`来实现
* 当页面不满足任何路由时，只是进入了包含404组件的页面，不会有一般的错误显示。404组件包含了回到正常路由（首页）的链接，可以很快回复到正常的网页逻辑中。
    
### 性能优化
本项目用到的一些前端的性能优化手段如下所示
* 预连接`preconnect`
    - 提前建立与接口URL的连接`<link rel="preconnect" href="接口URL">`
* 动态组件导入（按需加载）`const component = () => import('./components/<component-name>')`
    - 意义：当需要的时候，才去加载某一个组件，这样可以有效减少页面单次的加载量，提高速度和效率
* 防抖（debouncing）
    - 本项目中，推荐词功能是基于组件的`watch`属性来实现的，由于`v-model`的存在，每次`input`元素的变化都会引发`searchtxt`的变化，然后被`watch`监听记录下来，而`watch`监听中又进行了推荐接口的调用。如果用户连续输入英文字符，势必在短时间内引起多次的接口调用，容易造成服务器压力过载。防抖思想告诉我们，可以延迟进行接口调用，如果在某一个时间内没有进行动作，就进行接口调用，否则，就清空计时器重新计时。

## 总体流程
* 详见同时提交的演示视频
* 彩蛋如果说出来，就不是彩蛋了ヘ(_ _ヘ)

## 还有哪些地方可以做到更好
* [ ] 做一个去底部/回顶部按钮
* [ ] 推荐词列表的显示可以优化，让它“覆盖”在页面上，而不是向下“推动”已有的搜索结果
* [ ] 使用`history`作为项目的路由模式，可以获得一个更加优雅的URL显示
    - 与此同时，需要后端的配合
* [ ] 对搜索结果页面制作骨架屏，快速的网页结构显示可以提升用户体验
* [ ] 针对移动端页面使用基于swiper的页面切换，可以用到搜索结果页面的翻页效果上
* [ ] 将防抖和节流函数从组件中提取出来，作为全局可用的工厂方法
* [ ] 制作分页功能时，因为没想到更好的workaround，故尝试在首页和尾页继续向“溢出”的方向点击控制键时，采用了回退路由的模式，实际上本应取消导航的
    - 可能需要针对组件级别写一个`beforeRouteUpdate()`函数